function x = ar1input(Lx, a)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FIRST-ORDER AUTOREGRESSIVE SIGNAL GENERATOR.
%
% 15 December 2011
% 24 July 2012
% Danilo Comminiello
%
% Department of Information, Electronic and Telecommunication Engineering 
% 'Sapienza' University of Rome
% Via Eudossiana,18, I-00184 Roma, Italy
%
%
% DESCRIPTION:
% Generates a coloured Gaussian input signal using a first-order 
% autoregressive model.
% The adopted autoregressive model is: sqrt(1 - a^2)/(1 - az^(-1)).
%
%
% INPUT PARAMETERS:
%   Lx: length of the input signal
%   a: coefficient of the autoregressive model (a=0.8 suggested value)
%
% OUTPUT PARAMETERS:
%   x: input signal [Lx x 1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clc
[y,Fs]= audioread('C:\Users\NCC\Desktop\New folder\attachments_4\cleanfemale01.wav'); 
%sound(y,Fs);
Lx = length(y);
s = wgn(Lx, 1, 0);                                                      % Generate a white Gaussian noise
B = sqrt(1 - a^2);
A = [1 -a];
x = filter(B, A, s);                                                    % Generate AR1 input signal
x = x/max(abs(x));     

% Signal normalization

